# 白板网站 - 系统架构图

## 整体架构

```
┌─────────────────────────────────────────────────────────────┐
│                        用户浏览器                            │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │   用户 A        │  │   用户 B        │  │   用户 C        │ │
│  │  React App      │  │  React App      │  │  React App      │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────────────────────────────────────────────┘
                              │
                              │ WebSocket / HTTP
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                      Node.js 服务器                         │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │   Express       │  │   Socket.IO     │  │   内存存储       │ │
│  │   HTTP API      │  │   WebSocket     │  │   Whiteboards   │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

## 技术栈架构

### 前端架构
```
┌─────────────────────────────────────────────────────────────┐
│                    React 前端应用                            │
│                                                             │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │     App.tsx     │  │  MarkdownEditor │  │    Toolbar      │ │
│  │   主应用组件     │  │   编辑器组件     │  │   工具栏组件     │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
│           │                     │                     │       │
│           ▼                     ▼                     ▼       │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │   Socket.IO     │  │  React Markdown │  │   StatusBar     │ │
│  │   客户端连接     │  │   渲染组件       │  │   状态栏组件     │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
│                                                             │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  Tailwind CSS   │  │   TypeScript    │  │     Vite        │ │
│  │   样式系统       │  │   类型系统       │  │   构建工具       │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

### 后端架构
```
┌─────────────────────────────────────────────────────────────┐
│                    Node.js 后端服务                         │
│                                                             │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │    Express      │  │   Socket.IO     │  │   内存存储       │ │
│  │   HTTP 服务器   │  │   WebSocket     │  │   Whiteboards   │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
│           │                     │                     │       │
│           ▼                     ▼                     ▼       │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │   CORS 中间件    │  │   连接管理       │  │   内容同步       │ │
│  │   跨域支持       │  │   用户管理       │  │   实时更新       │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

## 数据流架构

### 实时协作数据流
```
用户 A 编辑内容
        │
        ▼
┌─────────────────┐
│  React 组件     │
│  内容更新       │
└─────────────────┘
        │
        ▼
┌─────────────────┐
│  Socket.IO      │
│  发送更新       │
└─────────────────┘
        │
        ▼
┌─────────────────┐
│  Node.js 服务器 │
│  接收并广播     │
└─────────────────┘
        │
        ▼
┌─────────────────┐
│  Socket.IO      │
│  广播给其他用户 │
└─────────────────┘
        │
        ▼
┌─────────────────┐
│  用户 B, C      │
│  接收更新       │
└─────────────────┘
```

### 组件通信架构
```
┌─────────────────┐
│     App.tsx     │
│   主应用组件     │
└─────────────────┘
         │
         │ props
         ▼
┌─────────────────┐
│ MarkdownEditor  │
│   编辑器组件     │
└─────────────────┘
         │
         │ callback
         ▼
┌─────────────────┐
│   Socket.IO     │
│   实时通信       │
└─────────────────┘
```

## 部署架构

### 开发环境
```
┌─────────────────┐    ┌─────────────────┐
│   Vite 开发服务器 │    │  Node.js 服务器  │
│   http://3000   │◄──►│   http://3001   │
│   前端应用       │    │   后端 API       │
└─────────────────┘    └─────────────────┘
```

### 生产环境
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Nginx 反向代理 │    │  Node.js 服务器  │    │   静态文件       │
│   http://80     │◄──►│   http://3001   │◄──►│   构建产物       │
│   负载均衡       │    │   后端服务       │    │   前端资源       │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

## 安全架构

### 网络安全
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   用户浏览器     │    │   防火墙        │    │   Node.js 服务器 │
│   客户端验证     │◄──►│   端口过滤      │◄──►│   服务端验证     │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

### 数据安全
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   内容验证       │    │   传输加密       │    │   存储安全       │
│   输入过滤       │◄──►│   HTTPS/WSS     │◄──►│   内存隔离       │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

## 扩展架构

### 多白板支持
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   白板 A        │    │   白板 B        │    │   白板 C        │
│   独立内容       │    │   独立内容       │    │   独立内容       │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         └───────────────────────┼───────────────────────┘
                                 ▼
                    ┌─────────────────┐
                    │   白板管理器     │
                    │   路由和分发     │
                    └─────────────────┘
```

### 数据库集成
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Node.js 服务器 │    │   数据库连接池   │    │   MongoDB/MySQL │
│   业务逻辑       │◄──►│   连接管理       │◄──►│   持久化存储     │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

## 监控架构

### 性能监控
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   应用指标       │    │   系统指标       │    │   业务指标       │
│   响应时间       │◄──►│   CPU/内存      │◄──►│   用户活跃度     │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

### 日志架构
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   应用日志       │    │   访问日志       │    │   错误日志       │
│   业务事件       │◄──►│   用户行为       │◄──►│   异常信息       │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```
